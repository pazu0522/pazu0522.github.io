---
title:  "단골 손님은 일반 손님보다 씀씀이가 더 클까?"
excerpt: "Mann-Whitney U-test (맨-휘트니 U-검정)"

categories:
  - 통계학
  - 데이터 분석
tags:
  - Mann-Whitney
  - 비모수통계

use_math: true
comments: true
last_modified_at: 2021-01-21T23:30:00
header:
  image: /assets/images/texture.jpg
---

<img src="/assets/images/mann_whitney_u-test/header.jpg" width="85%" height="85%" title="race" alt="race"/>

<br>
얼마 전 작은 가게의 매출 데이터를 받은 적이 있다. 흔히 가게를 운영할 때 단골 손님 확보의 중요성이 많이 언급되는 만큼, 단골 손님과 일반 손님으로 나누어서 데이터를 분석해 보았다. 과연 단골 손님은 일반 손님보다 씀씀이가 더 클까? 만약 실제로 그렇다면 매출을 늘리기 위해 단골 손님을 더 확보할 수 있는 전략을 고민해야 할 것이다. 

<img src="/assets/images/mann_whitney_u-test/boxplot.png" width="50%" height="50%" title="boxplot" alt="boxplot"/> 

아직 영업을 개시한 지 오래 되지 않은 가게였기 때문에 단골 손님의 기준을 넉넉하게 잡았다. 회원을 등록한 고객 중 2회 이상 방문한 고객을 단골 손님 그룹으로 분류했다. 두 그룹의 결제 금액 데이터를 박스 플롯으로 나타내보니 단골 손님 그룹의 결제 금액이 전반적으로 더 높은 것처럼 보인다. 하지만 그래프 상에 보이는 차이가 실제 통계적으로 유의한 수준인 지는 아직 물음표다. 보다 근거 있는 결론을 도출하기 위한 방법을 찾던 중, Mann-Whitney 검정에 대해 알게 되었다.

* * *
<br>

# Mann-Whitney U-test

- [**비모수검정**](https://pazu0522.github.io/%ED%86%B5%EA%B3%84%ED%95%99/%EB%8D%B0%EC%9D%B4%ED%84%B0%20%EB%B6%84%EC%84%9D/mann_whitney_u-test/#%EB%B9%84%EB%AA%A8%EC%88%98%EA%B2%80%EC%A0%95)
- [**U-test를 위한 조건**](https://pazu0522.github.io/%ED%86%B5%EA%B3%84%ED%95%99/%EB%8D%B0%EC%9D%B4%ED%84%B0%20%EB%B6%84%EC%84%9D/mann_whitney_u-test/#u-test%EB%A5%BC-%EC%9C%84%ED%95%9C-%EC%A1%B0%EA%B1%B4)
- [**가설 설정**](https://pazu0522.github.io/%ED%86%B5%EA%B3%84%ED%95%99/%EB%8D%B0%EC%9D%B4%ED%84%B0%20%EB%B6%84%EC%84%9D/mann_whitney_u-test/#%EA%B0%80%EC%84%A4-%EC%84%A4%EC%A0%95)
- [**$U$ 통계량 계산**](https://pazu0522.github.io/%ED%86%B5%EA%B3%84%ED%95%99/%EB%8D%B0%EC%9D%B4%ED%84%B0%20%EB%B6%84%EC%84%9D/mann_whitney_u-test/#u-%ED%86%B5%EA%B3%84%EB%9F%89-%EA%B3%84%EC%82%B0)
- [**가설 검정**](https://pazu0522.github.io/%ED%86%B5%EA%B3%84%ED%95%99/%EB%8D%B0%EC%9D%B4%ED%84%B0%20%EB%B6%84%EC%84%9D/mann_whitney_u-test/#%EA%B0%80%EC%84%A4-%EA%B2%80%EC%A0%95)
- [**정규분포 근사**](https://pazu0522.github.io/%ED%86%B5%EA%B3%84%ED%95%99/%EB%8D%B0%EC%9D%B4%ED%84%B0%20%EB%B6%84%EC%84%9D/mann_whitney_u-test/#%EC%A0%95%EA%B7%9C%EB%B6%84%ED%8F%AC-%EA%B7%BC%EC%82%AC)
- [**검정 결과 및 결론**](https://pazu0522.github.io/%ED%86%B5%EA%B3%84%ED%95%99/%EB%8D%B0%EC%9D%B4%ED%84%B0%20%EB%B6%84%EC%84%9D/mann_whitney_u-test/#%EA%B2%80%EC%A0%95-%EA%B2%B0%EA%B3%BC-%EB%B0%8F-%EA%B2%B0%EB%A1%A0)
- [**효과크기를 이용한 결론**](https://pazu0522.github.io/%ED%86%B5%EA%B3%84%ED%95%99/%EB%8D%B0%EC%9D%B4%ED%84%B0%20%EB%B6%84%EC%84%9D/mann_whitney_u-test/#%ED%9A%A8%EA%B3%BC%ED%81%AC%EA%B8%B0%EB%A5%BC-%EC%9D%B4%EC%9A%A9%ED%95%9C-%EA%B2%B0%EB%A1%A0)


## 비모수검정

**Mann-Whitney U-test**(이하, U-test)는 비모수검정에 해당한다. 비모수검정은 데이터가 모수(대표적으로 평균, 분산)로 표현 가능한 확률분포에서 나왔다고 가정하지 않고 실시하는 통계 검정 방법이다. 따라서 검정 과정에 모수에 대한 가정을 필요로 하지 않는다. 데이터의 개수가 너무 적거나 데이터가 정규분포를 따르지 않는 경우 비모수검정을 시도할 수 있다.

<img src="/assets/images/mann_whitney_u-test/histogram.png" width="80%" height="80%" title="histogram" alt="histogram"/>

만약 손님들의 결제 금액 데이터가 정규분포를 따르고 데이터의 분산이 일정하다는 것을 가정할 수 있다면 Student T-test(이하, T-test) 또는 Z-test를 통해 두 그룹의 평균을 비교해 볼 수 있다. 하지만 보다시피 결제 금액 데이터의 분포는 한쪽으로 치우쳐 있는 형태이다. 따라서 이 경우에 T-test나 Z-test 대신 U-test를 시도할 수 있다.


## U-test를 위한 조건

하지만 무조건 U-test를 사용할 수는 없다. 다음 몇 가지 조건을 충족해야만 U-test를 시도할 수 있다.
  
> 두 그룹의 데이터가 서로 **독립적**이어야 한다.

이 말은 즉, 단골 손님의 결제 금액이 일반 손님의 결제 금액에 영향을 미치지 않아야 한다는 것을 의미하며 그 반대 또한 마찬가지이다. 생각하기에 따라 다르겠지만 필자는 두 그룹이 독립적이라고 판단했다. 가게에서 다른 사람이 얼마를 쓰는지를 보고 자신이 얼마를 쓸 지를 결정한 적이 있는가? 보통은 그렇지 않지만 때때로 그럴 수 있다. 

술집에서 옆 테이블에 늘어져 있는 빈 술병을 보고 오기가 발동해서 평소보다 더 많은 술을 주문할 수 있다. 미용실에 파마를 하러 갔는데 옆 자리의 앉은 손님의 파마 상태를 보고 커트만 하고 나올 수도 있다. 하지만 필자가 데이터를 받은 가게의 업종은 손님끼리 마주칠 상황이 거의 없는 업종이기 때문에 결제 금액의 독립성이 보장되어 첫 번째 조건을 만족한다 보았다.

> 데이터의 **대소 관계**가 성립해야 한다.

대소 관계가 성립하지 않는 명목형 데이터의 경우는 U-test를 시도할 수 없다. 결제 금액은 당연히 대소 비교가 가능하므로 두 번째 조건을 만족한다.


## 가설 설정

- $H_{0}$ : 두 그룹의 데이터는 **동일한 모집단분포**에서 비롯하였다. 
- $P(X > Y) = P (X < Y)$  
- 분포가 같으므로 두 그룹의 중앙값도 같다. 

서로 다른 수가 적힌 공 여러 개가 들어 있는 주머니 두 개가 존재하고 $X$와 $Y$가 각각 한 개의 주머니를 받아 그 안에서 공 하나를 꺼내는 상황을 가정하자. 만약 두 주머니의 구성이 같다면 $X$의 수가 $Y$의 수보다 클 확률과 그 반대의 확률은 동일할 것이다.

- $H_{1}$ : 두 그룹의 데이터는 동일한 모집단분포에서 비롯되지 않았다. 
- $P(X > Y) \neq P (X < Y)$  
- 분포가 다르므로 두 그룹의 중앙값도 다르다.

위와 같은 상황에서 두 주머니의 구성이 서로 다르다면 $X$의 숫자가 $Y$의 숫자보다 클 확률과 그 반대의 확률은 같지 않을 것이다.


## $U$ 통계량 계산

위 가설을 검증하기 위해 $U$ 통계량을 계산해야 한다. 예제를 통해 $U$ 통계량 계산 과정을 설명하고자 한다.

$A$ 그룹 : $(100, 50, 45, 35, 15, 5)$  

$B$ 그룹 : $(90, 85, 80, 70, 60, 0)$

<span style="color:red">**STEP 1.**</span>  
$A$ 그룹에서 한 명의 선수를 출전시켜 $B$ 그룹의 모든 선수들과 1:1 대결을 한다. 점수가 큰 쪽이 승자가 된다.
$A$ 그룹 선수가 승리할 때마다 1점을 얻고, 비기면 0.5점을 얻는다. 패배하면 0점이다. $A$ 그룹의 선수가 6명, $B$ 그룹의 선수가 6명이므로 총 36번의 대결이 이루어진다. 모든 대결이 끝나고 $A$ 그룹이 획득한 승점을 $U_{A}$라 한다. 위 예제에서 $U_{A} = 11$이다.

<span style="color:red">**STEP 2.**</span>  
$A$ 그룹의 최종 점수와 $B$ 그룹의 최종 점수를 합하면 총 대결 횟수와 같아야 한다. 따라서 $U_{B} = 36-U_{A} = 25$가 된다.

다른 방법으로도 $U_{A}$와 $U_{B}$를 계산할 수 있다. $A$ 그룹과 $B$ 그룹의 데이터를 통합한 후 내림차순으로 정렬한다. 그리고 각 데이터를 그룹 명으로 라벨링 한 후, 가장 작은 값부터 등수를 매긴다. 동률이 발생하는 경우 평균값으로 등수를 조정한다. (11등, 10등 데이터가 동률이라면 10.5등, 10.5등으로 등수를 조정한다.)

|:---:|:---:|:---:|:---:|:---:|:---:|:---:|:---:|:---:|:---:|:---:|:---:|:---:|
|데이터 통합|$100$|$90$|$85$|$80$|$70$|$60$|$50$|$45$|$35$|$15$|$5$|$0$|
|라벨링|$A$|$B$|$B$|$B$|$B$|$B$|$A$|$A$|$A$|$A$|$A$|$B$|
|등수|$12$|$11$|$10$|$9$|$8$|$7$|$6$|$5$|$4$|$3$|$2$|$1$|  

여기서 등수는 곧 각 선수가 자기 자신과의 대결을 포함한 모든 선수와 대결을 했을 때 얻을 수 있는 승점과 같다. 각 그룹의 승점은 그룹에 속한 선수 개인이 획득한 승점의 합계에서 자기 자신과의 대결에서 얻은 승점(항상 승리)과 같은 그룹 선수와의 대결에서 얻은 승점을 모두 제외한 값과 같다. 

이에 따라, $R_{A}$를 그룹 $A$의 등수 합, $n_{A}$를 $A$ 그룹의 총 인원이라 하면 $U_{A} = R_{A} - \frac{n_{A}(n_{A}+1)}{2}$가 성립한다.  
$\frac{n_{A}(n_{A}+1)}{2}$가 의미하는 것이 바로 자기 자신, 같은 그룹 선수와의 총 매치업 수이다.  
같은 방법으로 $U_{B} = R_{B} - \frac{n_{B}(n_{B}+1)}{2}$가 된다.

<span style="color:red">**STEP 3.**</span>  
어떤 방법으로 $U_{A}$와 $U_{B}$를 계산하든 결과는 같으며 $U$ 통계량은 $U_{A}$와 $U_{B}$ 중 어느 것을 택해도 상관 없지만 추후 U-test 테이블을 이용하기 위해 작은 값을 선택하면 된다. 따라서 위 예제에서 $U$ 통계량은 $11$이 된다.

한편, $U_{A}$와 $U_{B}$ 차이의 최댓값은 $n_{A}n_{B}$이다. 한 그룹이 다른 그룹을 완전히 압도할 때 발생한다.  
데이터를 라벨링한 결과가 $(A, A, A, A, A, A, B, B, B, B, B, B)$와 같다면 $U_{A} = 36$이고 $U_{B} = 0$이므로 그 차이가 36이 된다.

$U_{A}$와 $U_{B}$ 차이의 최솟값은 $\frac {n_{A}n_{B}}{2}$이다. 완전히 박빙의 승부가 펼쳐질 때 발생한다.  
데이터를 라벨링한 결과가 $(A, B, B, A, A, B, B, A, A, B, B, A)$와 같다면

$U_{A} = 6+4+4+2+2 = 18,$  

$U_{B} = 5+5+3+3+1+1 = 18$로 그 차이가 0이 된다. 

데이터 라벨링 결과를 보면 쉽게 알 수 있듯, $U_{A}$와 $U_{B}$ 간 차이가 클수록 두 그룹 간 차이가 두드러지고, $U_{A}$와 $U_{B}$ 차이가 작을수록 그룹 간 차이가 희미해진다. $U_{A}$와 $U_{B}$ 차가 크면(이 경우에 $U$ 통계량의 값은 작을 것이다.) 대립가설의 채택 가능성이 높아지고 $U_{A}$와 $U_{B}$ 차가 작으면(이 경우에 $U$ 통계량의 값은 클 것이다.) 귀무가설의 채택 가능성이 높아진다.

<span style="color:red">**STEP 4.**</span>  
이제 위 과정을 처음 문제에 그대로 대입하여 수식으로 표현하면 다음과 같다.

$X$ : 단골 손님 그룹의 결제 금액

$X_{i}$ : 단골 손님 그룹의 $i$번째 결제 금액 $(i = 1, 2, \cdots, n)$

$Y$ : 일반 손님 그룹의 결제 금액

$Y_{j}$ : 일반 손님 그룹의 $j$번째 결제 금액 $(j = 1, 2, \cdots, m)$

$U$ 통계량 계산식을 함수로 표현하면,

\begin{align}
U_{X} = \sum_{i}^{n}\sum_{j}^{m}S(X_{i}, Y_{j}) = R_{X} - \frac {n_{X}(n_{X}+1)}{2} \nonumber
\end{align}

\begin{align}
S(X_{i}, Y_{j}) = 
  \begin{cases} 
  1 & \text{$X_{i} > Y_{j}$} \\\\\\
  0 & \text{$X_{i} < Y_{j}$} \\\\\\
  \frac{1}{2} & \text{$X_{i} = Y_{j}$} \nonumber
  \end{cases}
\end{align}

\begin{align}
U = min(U_{X}, U_{Y})\nonumber
\end{align}

이전에 언급한 대로 U-test 테이블을 사용하기 위해 작은 값을 선택한 것일 뿐, 둘 중에 아무거나 선택해도 상관 없다. 계산된 두 통계량이 평균을 기준으로 대칭이기 때문이다.


## 가설 검정

우선, $U$ 통계량을 임계치와 비교하기 위해 U-test 테이블이 필요하다. 양측 검정, 유의수준 $a = 0.05$일 때 U-test 테이블은 아래와 같다.

<img src="/assets/images/mann_whitney_u-test/table.png" width="80%" height="80%" title="table" alt="table"/>

다시 예제로 돌아가서 $A$ 그룹의 선수가 6명, $B$ 그룹의 선수가 6명이었으므로 표에서 $n_{A} = 6$, $n_{B} = 6$이 교차하는 지점을 찾는다. 표가 완전히 대칭적이기 때문에 $n_{A}$와 $n_{B}$가 바뀌어도 상관이 없다. 아무튼 교차 지점에 해당하는 값 $5$가 바로 임계치이다. 이제 임계치와 $U$ 통계량을 비교한다.

$U$ 통계량이 임계치보다 더 작은 경우 $H_{0}$을 기각하고 $H_{1}$ 채택한다. $U$ 통계량이 임계치보다 더 큰 경우 $H_{0}$을 채택하고 $H_{1}$을 기각한다. 예제의 경우 $U$ 통계량 $11$이 임계치 $5$보다 크기 때문에 귀무가설을 채택한다.


## 정규분포 근사

위의 U-test 테이블을 보면 $n_{A}$과 $n_{B}$가 20 이하인 경우의 임계치만 확인할 수 있다. 전체 데이터 개수가 20개를 초과하는 경우에는 통상적으로 U-test보다는 정규분포 근사를 이용한 모수검정을 실시한다고 한다. 가게 매출 데이터는 20개를 훨씬 초과하기 때문에 정규분포 근사를 이용한 모수검정이 가능하다. 이를 위해서는 다음과 같은 추가 작업이 필요하다.

\begin{align}
Z = \frac {(U - \mu_{U})}{\sigma_{U}} \sim N(0, 1) \nonumber
\end{align}

\begin{align}
\mu_{U} = E(U) = \frac {n_{X}n_{Y}}{2} \nonumber
\end{align}

\begin{align}
\sigma_{U} = \sqrt{Var(U)} = \sqrt{\frac {n_{X}n_{Y}(n_{X}+n_{Y}+1)}{12}} \nonumber
\end{align}

\begin{align}
n = n_{X} + n_{Y} \nonumber
\end{align}

데이터에 동률이 있는 경우 표준편차를 계산하는 식에 수정항이 추가되어 계산식이 조금 더 복잡해지는데 이는 [위키피디아](https://en.wikipedia.org/wiki/Mann%E2%80%93Whitney_U_test)에 자세히 설명되어 있다.

$U$의 기댓값과 분산 및 표준편차는 다음과 같은 과정으로 계산되었다.

* * *

> $U$의 **기댓값**

<span style="color:red">**STEP 1.**</span>  
우선, 각 데이터 순위 $R_{i}$의 기댓값인 $E(R_{i})$를 계산해야 한다. $F$를 $X$의 확률분포, $G$를 $Y$의 확률분포라 하면 처음에 설정한 가설 $H_{0}$에서 $F=G$로 설정했으므로 각 데이터가 획득할 수 있는 순위는 $1$부터 $n$까지이며 각 순위를 얻게 될 확를은 모두 동일하다.

서로 다른 수가 적힌 공 $N$개가 들어 있는 주머니에서 $N$명의 사람이 주머니에서 공 하나씩을 꺼내 수의 크기 순으로 순위를 결정하는 상황을 가정하자. 이 때, 공을 꺼내는 순서 또한 완전 무작위로 결정된다면 모든 사람이 $1$등이 될 확률부터 $n$등이 될 확률까지 모두 $\frac{1}{n}$로 동일할 것이다. 따라서 $E(R_{i})$는 순위 합의 단순 평균과 같다. 따라서,

\begin{align}
E(R_{i}) = \frac {1}{n}\sum_{i}^{n}R_{i} = \frac {1}{n}\cdot \frac{n(n+1)}{2} = \frac {n+1}{2} \nonumber
\end{align}

<span style="color:red">**STEP 2.**</span>  
$E(R_{i})$를 바탕으로 $E(R_{X})$를 계산하고 $E(R_{X})$를 바탕으로 $E(U)$를 계산한다.

\begin{align}
E(R_{X}) = E\left(\sum_{i}^{n_{X}}R_{i}\right) = \sum_{i}^{n_{X}}E(R_{i}) = n_{X}\cdot \frac{n+1}{2} = \frac{n_{X}(n_{X}+n_{Y}+1)}{2}\nonumber
\end{align}

\begin{align}
E(U_{X}) = E(U) = E\left(R_{X} - \frac{n_{X}(n_{X}+1)}{2}\right) = \frac{n_{X}n_{Y}}{2} \nonumber
\end{align}

* * *

> $U$의 **분산**과 **표준편차**

<span style="color:red">**STEP 1.**</span>  
분산과 표준편차 역시 $R_{i}$의 분산을 구하는 데서 출발한다.

\begin{align}
Var(R_{i}) = E(R_{i}^{2}) - E(R_{i})^{2} = \frac {n^{2}-1}{12} \nonumber
\end{align}

\begin{align}
E(R_{i})^{2} = \frac {1}{n}\cdot\frac {n(n+1)(2n+1)}{6} = \frac {(n+1)(2n+1)}{6} \nonumber
\end{align}

$E(R_{i}^{2})$은 각 순위를 제곱한 후 합한 값을 단순 평균한 것에 불과하므로 제곱합 공식을 사용해서 쉽게 계산할 수 있다. 

<span style="color:red">**STEP 2.**</span>  
다음으로 $R_{i}$와 $R_{j}$의 **공분산**을 계산한다.

\begin{align}
Var\left(\sum_{i}^{n}R_{i}\right) = \sum_{i}^{n}Var(R_{i}) + 2\cdot Cov(R_{i}, R_{j})\cdot \frac{n(n-1)}{2}, && i \neq j \nonumber
\end{align}

$\sum_{i}^{n}R_{i} = \frac{n(n+1)}{2}$로 상수이기 때문에 좌변은 $0$이다. 따라서,

\begin{align}
0 = \frac{n(n-1)(n+1)}{12} + 2\cdot Cov(R_{i}, R_{j})\cdot \frac{n(n-1)}{2} \nonumber
\end{align}

\begin{align}
\therefore Cov(R_{i}, R_{j}) = -\frac{n+1}{12} \nonumber
\end{align}

그런데 잠깐, 정규분포 근사를 위해서는 **중심극한정리**를 사용할 수 있어야 한다. 그리고 중심극한정리를 사용하기 위해서는 확률변수를 독립적이고 동일한 분포를 따르는(i.i.d) 확률변수들의 합으로 나타낼 수 있어야 한다. 앞에서 $U$를 $R$들의 합으로 나타냈는데 이들은 서로 독립이 아니다. 위에서 계산한 결과에 따르면 공분산이 0이 아니기 때문이다. 

그래서 Cross Validated에 $U$를 i.i.d 확률변수들의 합으로 표현할 수 있는 방법이 있는지에 대한 질문을 올렸는데 안타깝게도 적절한 답변을 얻지 못했다. 대신, 확률변수들이 종속인 경우에도 특정 조건 하에 정규분포 근사가 가능하다는 답변을 얻었다. 그래서 확률변수들이 종속인 경우의 정규분포 근사에 대한 자료를 찾아 보았는데 아직 필자가 이해하기에는 너무 어려운 내용이라 일단은 이쯤에서 넘어가기로 했다.

<span style="color:red">**STEP 3.**</span>  
이제 $Var(U)$와 $\sigma_{U}$를 계산할 수 있다.

\begin{align}
Var(U_{X}) = Var(U) \nonumber
\end{align}
\begin{equation\*}
\begin{aligned}
&= Var\left( R_{X}-\frac{n_{X}(n_{X}+1)}{2}\right ) = Var(R_{X}) \\\\\\ \\\\\\
&= Var(R_{1}+R_{2}+ \cdots+ R_{n_{X}}) \\\\\\ \\\\\\
&= n_{X}\cdot Var(R_{1}) + 2\cdot Cov(R_{1}, R_{2})\cdot \frac{n_{X}(n_{X}-1)}{2} \\\\\\ \\\\\\
&= n_{X}\cdot \frac{(n^{2}-1)}{12} - \frac{n+1}{12}\cdot n_{X}(n_{X}-1) \\\\\\ \\\\\\
&= \frac {n_{X}n_{Y}(n_{X}+n_{Y}+1)}{12} \nonumber
\end{aligned}
\end{equation\*}

\begin{align}
\therefore \sigma_{U} = \sqrt {\frac {n_{X}n_{Y}(n_{X}+n_{Y}+1)}{12}} \nonumber
\end{align}


## 검정 결과 및 결론

가게 매출 데이터에 대해 위와 같은 방법으로 정규분포 근사 및 Z-test를 진행한 결과 $Z = 2.562$이고 $p = 0.010$으로 나타났다. 따라서 유의수준 $a = 0.05$에서 $H_{0}$을 기각하고 $H_{1}$를 채택한다. 따라서 결론은 다음과 같다.

> 두 그룹의 데이터는 동일한 모집단분포에서 비롯되지 않았다.

단측검정의 경우 $p = 0.005$이므로 역시 $H_{0}$을 기각한다. 따라서 결론은 다음과 같다.

> 단골 손님 그룹의 결제 금액 **중앙값**이 일반 손님 그룹의 결제 금액 **중앙값**보다 크다.


## 효과크기를 이용한 결론

위와 같이 $p-value$를 통해 결론을 내릴 때 사용된 대푯값이 평균이었다면 충분히 만족스러웠을텐데, 평균이 아닌 중앙값이라 결론이 조금은 아쉽게 느껴진다.

단순히 두 그룹 사이에 유의한 차이가 있다 또는 없다와 같은 이분법적인 결론이 아니라 구체적으로 얼마만큼의 차이가 있는지를 알고 싶다면 **효과크기**를 통한 결론 도출을 고려할 수 있다.

효과크기란 비교하려는 그룹 간 차이 혹은 관계를 나타내는 **표준화** 된 지표를 의미한다. 표준화하였기 때문에 단위의 영향을 받지 않는다는 장점이 있다. $U$ 통계량에 대한 효과크기는 다음과 같이 계산된다.

\begin{align}
\frac{max(U_{X}, U_{Y})}{n_{X}n_{Y}} \nonumber
\end{align}

앞서 언급한 바, $U$ 통계량의 최댓값은 $n_{X}n_{Y}$이고 최솟값은 $0$이기 때문에 효과크기는 0에서 1까지의 값을 가지게 된다. 값의 범위가 0에서 1까지이므로 하나의 **확률**로 해석 가능하다. 즉, $U$ 통계량을 이용하여 계산한 효과크기는 임의의 $X$ 그룹 데이터 값이 임의의 $Y$ 그룹 데이터 값보다 클 확률로 생각할 수 있다. $U$ 통계량의 최솟값을 이용하여 효과크기를 계산했다면 값이 더 작을 확률이 된다.

가게 매출 데이터에 대해 효과크기를 계산한 결과는 $0.617$이다. 따라서 결론은 다음과 같다.

> 단골 손님 그룹의 결제 금액이 일반 손님 그룹의 결제 금액보다 클 확률은 $61.7\%$이다.

앞서 $p-value$를 이용한 결론에 비해 직관적이고 구체적이다. 그렇다고 해도, 막상 도출된 $61.7\%$라는 수치가 드라마틱하게 느껴지지는 않는다. 하지만 COVID-19로 가게를 찾는 손님 한 명이 아쉬운 작금의 상황에서는, 스쳐가는 손님을 단골 손님으로 바꾸기 위한 시도가 어려운 상황을 조금이라도 타개할 수 있는 방법이지 않을까 하는 생각이 든다.

* * *
<br>

# 3. 참고 자료

- [**위키피디아: Mann-Whitney U-test**](https://en.wikipedia.org/wiki/Mann%E2%80%93Whitney_U_test)
- [**MPH Online Learning Modules**](https://sphweb.bumc.bu.edu/otlt/mph-modules/bs/bs704_nonparametric/bs704_nonparametric4.html)
- [**Hanyang Medical Reviews**](https://www.researchgate.net/publication/276462375_Understanding_Effect_Sizes/fulltext/55d8fa9b08aeb38e8a87bc9a/Understanding-Effect-Sizes.pdf)