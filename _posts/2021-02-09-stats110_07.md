---
title:  "확률론 기초(Stats 110) : Lesson 07. Gambler's Ruin & Random Variables"
excerpt: "하버드 대학교 조셉 K. 블리츠타인 교수의 Stats 110 7강 정리"

categories:
  - 통계학
  - 확률론
tags:
  - 조건부 확률
  - 확률변수
  - 확률분포
  - 베르누이분포
  - 이항분포
use_math: true
comments: true
last_modified_at: 2021-02-09T23:30:00
header:
  image: /assets/images/texture.jpg
---

<img src="/assets/images/stats_110/lesson_07.jpg" width="75%" height="75%" title="bankrupt" alt="bankrupt"/> 

# 1. 조건부 확률

- [**도박꾼의 파산**](https://pazu0522.github.io/%ED%86%B5%EA%B3%84%ED%95%99/%ED%99%95%EB%A5%A0%EB%A1%A0/stats110_07/#%EB%8F%84%EB%B0%95%EA%BE%BC%EC%9D%98-%ED%8C%8C%EC%82%B0)


## 도박꾼의 파산
  
> 도박꾼 $A, B$ 중 어느 한 쪽이 파산할 때까지 계속 진행되는 도박이 존재한다.  
> 처음에 $A$가 $i$달러, $B$가 $N-i$달러를 보유한 채로 게임을 시작한다.  
> 두 도박꾼은 매 라운드에 $1$달러씩 배팅하며 매 라운드의 승부는 독립적이다.  
> 이 때, $A$가 도박에서 최종 승리($B$가 파산)하게 될 확률은?

$A$가 라운드에서 승리하는 사건을 $A$, $B$가 라운드에서 승리하는 사건을 $B$로 정의한다. 그리고 $A$가 라운드에서 승리할 확률 $P(A)$를 $p$, $B$가 라운드에서 승리할 확률 $P(B)$를 $q = 1-p$로 정의한다.

$E_{i}$를 $A$가 처음에 $i$달러를 가지고 도박을 시작했을 때 최종 승리하는 사건으로 정의하고, $P_{i}$를 $A$가 처음에 $i$달러를 가지고 도박을 시작했을 때 최종 승리할 확률로 정의하면 **베이즈 정리**와 **전체 확률의 법칙**에 의해 다음이 성립한다.

\begin{align}
P_{i} = P(E_{i}) = P(E_{i} \mid A) \cdot P(A) + P(E_{i} \mid A^{c}) \cdot P(A^{c}) \nonumber
\end{align}

즉, 최종 승리 확률은 현재 라운드에서 승리하고 최종 승리를 얻어낼 확률과 현재 라운드에서 패배하고 최종 승리를 얻어낼 확률의 합으로 나타낼 수 있다. 이 때 $P(A) = p$, $P(A^{c}) = 1-p = q$로 다시 쓸 수 있다.

$P(E_{i} \mid A)$는 $A$가 첫 라운드에서 승리했을 때 최종 승리 확률이다. 첫 라운드에서 승리한 경우 $A$는 $i+1$달러를 보유하게 되고 매 라운드가 **독립적**이므로 이는 결국 $A$가 처음에 $i+1$달러를 보유한 채로 도박을 시작했을 때 최종 승리 확률과 같다. 따라서 $P(E_{i} \mid A) = P(E_{i+1}) = P_{i+1}$이다. 마찬가지로 $P(E_{i} \mid A^{c})$는 $A$가 첫 라운드에서 패배했을 때 최종 승리 확률이다. 첫 라운드에서 패배한 경우 $A$는 $i-1$달러를 보유하게 되고 역시 매 라운드가 독립적이므로 이는 결국 $A$가 처음에 $i-1$달러를 보유한 채로 도박을 시작했을 때 최종 승리 확률과 같다. 따라서 $P(E_{i} \mid A^{c}) = P(E_{i-1}) = P_{i-1}$이다.

위에서 정의한대로 $P(A) = p$이고 $P(A^{c}) = 1-p = q$이므로 위 식을 아래와 같은 **계차방정식**으로 변환 가능하다. 

\begin{align}
P_{i} = p \cdot P_{i+1} + q \cdot P_{i-1}, \quad 1 \leq i \leq N-1 \nonumber
\end{align}

단, **경계 조건**을 설정할 필요가 있다. $A$가 파산한 상태에서 도박을 시작했을 때 최종 승리할 확률인 $P_{0}$은 당연히 $0$이다. 한 쪽이 파산하는 순간 도박이 끝나기 때문이다. 반대로 $B$가 파산한 상태에서 도박을 시작했을 때 최종 승리할 확률 즉, $A$가 $N$달러를 보유한 상태에서 도박을 시작했을 때 최종 승리할 확률인 $P_{N}$은 $1$이 된다.

이제 위 계차방정식을 풀이하면 $A$가 도박에서 최종 승리($B$가 파산)하게 될 확률을 계산할 수 있게 된다.

* * *

> **계차방정식**의 풀이

<span style="color:red">**STEP 1.**</span>  
$P_{i} = p \cdot P_{i+1} + q \cdot P_{i-1}$에서 $P_{i} = x^{i}$로 놓고 원래의 계차방정식에 대입하면 $x^{i} = p \cdot x^{i+1} + q \cdot x^{i-1}$가 된다. 그런데 $x=0$인 경우 역시 계차방정식을 만족하지만 $P_{N} = 1$ 조건을 만족하지 못하게 되므로 $x \neq 0$로 설정한다.

$x \neq 0$이므로 양 변을 $x^{i-1}$로 나누어 줄 수 있다. 그렇게 하면 $x$에 대한 이차식을 얻을 수 있다.

\begin{align}
p \cdot x^{2} - x + q = 0 \nonumber
\end{align}
\begin{align}
x = \frac{1 \pm \sqrt {(1-4pq)}}{2p} =  \frac{1 \pm \sqrt {(2p-1)^{2}}}{2p} \quad \because q = 1-p \nonumber
\end{align}
\begin{align}
\therefore x = 1, \; \frac{q}{p} \nonumber
\end{align}

<span style="color:red">**STEP 2.**</span>  
계차방정식 풀이 시, 다항식 해가 모두 다르다면 계차방정식의 일반해는 다항식 해의 선형 결합의 형태로 나타난다. 따라서 $p \neq q$ 즉, $p \neq \frac{1}{2}$인 경우 **STEP 1**에서의 다항식 해가 모두 다르게 되므로 계차방정식의 일반해는 다음과 같다.

\begin{align}
P_{i} = a \times 1^{i} + b \times (\frac{q}{p})^{i} \nonumber
\end{align}

위 일반해는 $P_{0}$과 $P_{N}$일 때 역시 성립해야 한다.

\begin{align}
P_{i} = 0 = a+b \quad \therefore a = -b \nonumber
\end{align}
\begin{align}
P_{N} = 1 = a + b \cdot (\frac{q}{p})^{N} = a - a \cdot (\frac{q}{p})^{N} = a \left( 1-(\frac{q}{p})^{N} \right) \nonumber
\end{align}
\begin{align}
\therefore a = \frac{1}{1-(\frac{q}{p})^{N}} \nonumber
\end{align}

계산된 $a$와 $b$를 원래 계차방정식 일반해 식에 대입하면 결국 다음과 같은 해를 얻는다.

\begin{align}
P_{i} = \frac{1}{1-(\frac{q}{p})^{N}} - \frac{(\frac{q}{p})^{i}}{1-(\frac{q}{p})^{N}} = \frac{1-(\frac{q}{p})^{i}}{1-(\frac{q}{p})^{N}} \;, \quad p \neq q \nonumber
\end{align}

<span style="color:red">**STEP 3.**</span>  
한편 $p=q$인 경우 다항식의 해에 중복해가 존재하므로 다른 방식의 접근이 필요하다. $t = \frac{p}{q}$로 놓고 극한을 취해 $t \to 1$로 보낸다. 그러면 $p \neq q$이므로 **STEP 2**에서 계산한 계차방정식의 일반해를 다시 사용할 수 있게 된다.

\begin{align}
\frac{1-(\frac{q}{p})^{i}}{1-(\frac{q}{p})^{N}} = \frac{1-t^{i}}{1-t^{N}} \nonumber
\end{align}

극한을 취해 $t \to 1$로 보내고 **로피탈의 정리**를 사용한다.

\begin{align}
\lim_{t \to 1} \frac{1-t^{i}}{1-t^{N}} = \lim_{t \to 1} \frac{i \cdot t^{i-1}}{N \cdot t^{N-1}} = \frac{i}{N} \nonumber
\end{align}

$t$가 $1$에 가까워질수록 즉, $p$가 $\frac{1}{2}$에 가까워질수록 $P_{i}$가 $\frac{i}{N}$에 가까워진다. 하지만 아직 극한값이 계차방정식의 일반해라는 것은 장담할 수 없다. 실제로 처음의 계차방정식에 $P_{i} = \frac{i}{N}$을 대입하였을 때 식이 성립해야 한다. 그런데 $p=q=\frac{1}{2}$일 때, $\frac{i}{N} = \frac{1}{2} \cdot \frac{i+1}{N} + \frac{1}{2} \cdot \frac{i-1}{N}$가 성립하므로 $\frac{i}{N}$은 $p=q$일 때 계차방정식의 해이다.

$p$와 $q$를 반대로 대입하고 $i$ 대신 $N-i$를 대입하면 $B$가 도박에서 최종 승리할 확률이 된다. 그리고 $A$가 이길 확률과 $B$가 이길 확률을 더하면 $1$이 되므로 이 도박이 승부가 나지 않고 영원히 지속될 확률은 $0$이다.

* * * 
<br>

# 2. 확률변수

- [**확률변수와 확률분포**](https://pazu0522.github.io/%ED%86%B5%EA%B3%84%ED%95%99/%ED%99%95%EB%A5%A0%EB%A1%A0/stats110_07/#%ED%99%95%EB%A5%A0%EB%B3%80%EC%88%98%EC%99%80-%ED%99%95%EB%A5%A0%EB%B6%84%ED%8F%AC)
- [**베르누이 분포**](https://pazu0522.github.io/%ED%86%B5%EA%B3%84%ED%95%99/%ED%99%95%EB%A5%A0%EB%A1%A0/stats110_07/#%EB%B2%A0%EB%A5%B4%EB%88%84%EC%9D%B4%EB%B6%84%ED%8F%AC)
- [**이항분포**](https://pazu0522.github.io/%ED%86%B5%EA%B3%84%ED%95%99/%ED%99%95%EB%A5%A0%EB%A1%A0/stats110_07/#%EC%9D%B4%ED%95%AD%EB%B6%84%ED%8F%AC)


## 확률변수와 확률분포

- **확률변수** : 표본공간 내의 **함수**로써 표본 공간의 원소$(s)$를 실수로 매핑
- **확률분포** : 확률변수가 특정한 값을 가질 확률을 나타내는 함수

<img src="/assets/images/stats_110/lesson_07_1.jpg" width="80%" height="80%" title="example1" alt="example1"/>

동전을 던지거나 주사위를 던지는 등의 확률 시행이 끝나면 어떤 결과(동전의 앞, 뒷면 또는 주사위의 눈 개수)를 관측하게 된다. 관측한 값은 표본공간 $S$ 안에 존재하는 어떤 원소인 $s$와 같다. 그런데 동전을 던지는 경우 표본공간의 원소는 $H$와 $T$로, $s$는 반드시 실수가 아닐 수도 있다. 이런 경우 어떤 수학적인 연산을 하기 어렵다. 확률변수는 확률 시행의 결과물인 $s$를 실수 공간으로 매핑하여 수학적 연산이 가능토록 만들어 준다.

확률변수가 가질 수 있는 값들을 원소로 하는 집합에서 원소의 개수를 셀 수 있다면 **이산확률변수** 그렇지 못하다면 **연속확률변수**로 구분한다. 엄밀히 말하면 **가산**(셀 수 있음)의 개념은 일반적으로 생각하는 집합의 원소가 유한한가 또는 무한한가와 다르다고 한다. 예를 들어 포아송분포를 따르는 확률변수의 경우 $0$ 이상의 모든 정수를 값으로 가질 수 있다. 그러나 수학에서 [가산](https://ko.wikipedia.org/wiki/%EA%B0%80%EC%82%B0_%EC%A7%91%ED%95%A9)의 개념은 일상에서의 그것과 다르기 때문에 포아송분포를 따르는 확률변수는 원소의 개수를 셀 수 있는 이산확률변수에 속한다.

**이산확률분포**, **연속확률분포**는 각각 이산확률변수와 연속확률변수에 대응된다. 또한 이산확률분포는 **확률질량함수(PMF)**에 의해 표현되고 연속확률분포는 **확률밀도함수(PDF)**에 의해 표현된다.

현재 이산확률변수와 이산확률분포에 대해 다루고 있으므로 PMF의 성립 조건만 살펴보면, 이산확률변수가 가질 수 있는 값을 $a_{1}, a_{2}, \cdots, a_{n}$ 또는 $a_{1}, a_{2}, \cdots, a_{\infty}$로 정의했을 때 PMF는 다음 두 가지 조건을 충족해야 성립한다.

- 모든 $j$에 대하여 $P(X=a_{j}) \geq 0$
- $\sum_{j}P(X=a_{j}) = 1$


## 베르누이분포

확률변수 $X$가 $0$ 또는 $1$의 값만을 가질 수 있을 때 $X$를 **베르누이 확률변수**라고 한다. 결과가 성공과 실패의 **두 가지**로만 나뉘는 실험 또는 시행을 **베르누이 시행**이라 하는데, 이 때 베르누이 확률변수는 일반적으로 베르누이 시행의 성공을 $1$로, 실패를 $0$으로 매핑한다. 여기서 성공이라 하면 실험자가 원하는 사건의 발생을 뜻한다. 만약 실험자가 '철수의 지각'을 성공으로 지정한다면 철수가 지각하는 것이 곧 성공이 되는 것이다. 따라서 성공을 $0$으로 매핑하느냐 $1$로 매핑하느냐는 사실상 큰 의미를 가지지 않는다.

베르누이 확률변수의 확률분포 $Bern(p)$의 **확률질량함수(PMF)**는 다음과 같다. $Bern(p)$에서 $p$는 **성공 확률**을 나타낸다.

\begin{align}
P(X=k) = 
  \begin{cases} 
  p & X = 1 \\\\\\
  1-p & X = 0 , \quad 0 \leq p \leq 1 \nonumber
  \end{cases}
\end{align}

$p$와 $1-p$ 모두 0보다 크거나 같으며 둘의 합이 $1$이 되기 때문에 PMF가 되기 위한 두 가지 조건을 모두 만족한다. PMF의 형태는 매우 단순한데, 시행의 결과가 성공일 확률인 $P(X=1)$은 당연히 $p$와 같고 실패일 확률인 $P(X=0)$은 $1-p$와 같다.


## 이항분포

$n$번의 **독립적**인 베르누이 시행에서 성공한 횟수를 값으로 가지는 확률변수를 **이항확률변수**라고 한다. 그리고 **이항분포**는 이항확률변수에 대한 확률분포이다.

이항확률변수의 확률분포 $Bin(n, p)$의 **확률질량함수(PMF)**는 다음과 같다. $Bin(n, p)$에서 $n$은 **시행 횟수**를, $p$는 **성공 확률**을 나타낸다.

\begin{align}
P(X=k) = \binom{n}{k}p^{k}(1-p)^{n-k}, \quad 0 \leq k \leq n, \quad q = 1-p \nonumber
\end{align}

예를 들어 7번의 주사위 던지기 중 1이 4번 나올 확률은 $\binom{7}{4} \times (\frac{1}{6})^{4} \times (\frac{5}{6})^{3}$이다. 이항분포의 PMF를 살펴보면 절대로 음수가 나올 수 없는 구조이다. 따라서 PMF의 첫 번째 조건을 만족한다. 또한 $\sum_{n=0}^{k}\binom{n}{k}p^{k}(1-p)^{n-k}$는 [이항 정리](https://ko.wikipedia.org/wiki/%EC%9D%B4%ED%95%AD_%EC%A0%95%EB%A6%AC)에 의해 $(p+q)^{n} = (p+(1-p))^{n} = 1$이므로 두 번째 조건 또한 만족한다. 

