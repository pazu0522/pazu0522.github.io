---
title:  "확률론 기초(Stats 110) : Lesson 10. Expectation & Probability Distributions (2)"
excerpt: "하버드 대학교 조셉 K. 블리츠타인 교수의 Stats 110 10강 정리"

categories:
  - 통계학
  - 확률론
tags:
  - 기댓값
  - 음이항분포
use_math: true
comments: true
last_modified_at: 2021-02-15T23:30:00
header:
  image: /assets/images/texture.jpg
---

<img src="/assets/images/stats_110/lesson_10.jpg" width="75%" height="75%" title="peaks" alt="peaks"/> 

# 1. 기댓값

- [**극댓값 문제**](https://pazu0522.github.io/%ED%86%B5%EA%B3%84%ED%95%99/%ED%99%95%EB%A5%A0%EB%A1%A0/stats110_10/#%EA%B7%B9%EB%8C%93%EA%B0%92-%EB%AC%B8%EC%A0%9C)
- [**상트페테르부르크 역설**](https://pazu0522.github.io/%ED%86%B5%EA%B3%84%ED%95%99/%ED%99%95%EB%A5%A0%EB%A1%A0/stats110_10/#%EC%83%81%ED%8A%B8%ED%8E%98%ED%85%8C%EB%A5%B4%EB%B6%80%EB%A5%B4%ED%81%AC-%EC%97%AD%EC%84%A4)


## 극댓값 문제

> $1$부터 $n$까지 정수로 구성된 임의의 수열이 존재한다. 단, $n \geq 2$이다.  
> 수열에서 어떤 수가 인접한 두 수보다 크면 해당 수를 **극댓값**이라고 한다.  
> 단, 수열의 양 끝에 존재하는 수는 인접한 하나의 수보다 크면 **극댓값**이 된다.  
> 극댓값을 위와 같이 정의할 때 **극댓값 개수의 기댓값**은?

<img src="/assets/images/stats_110/lesson_10_1.jpg" width="50%" height="50%" title="example1" alt="example1"/>

정수 $1$부터 $n$까지의 임의의 수열에서 **극댓값의 개수**를 확률변수 $I$로 정의하고, 수열에서 $j$번째 값의 **극댓값 여부**에 대한 **지시확률변수** $I_{j}$를 정의한다. 즉, $I_{j}$는 $j$번째 값이 극댓값에 해당하는 경우 $1$의 값을 가지고 그렇지 않은 경우 $0$의 값을 가진다. 확률변수 $I$는 지시확률변수 $I_{j}$의 합으로 표현할 수 있다.

\begin{align}
I_{j} = 
  \begin{cases} 
  1 & \text{j'th element local maximum} \\\\\\
  0 & \text{j'th element not local maximum} \nonumber
  \end{cases}
\end{align}

\begin{align}
I = I_{1} + I_{2} + \cdots + I_{n} \nonumber
\end{align}

수열의 $j$번째 값이 극댓값이 될 확률은 해당 값의 위치에 따라 조금 달라진다. 우선 $j$번째 값이 수열의 중간에 위치하는 경우 즉, $j \neq 1$ 또는 $j \neq n$이면 인접한 두 개의 수와 자신을 포함한 세 수 중에 가장 큰 값이 $j$번째에 위치하면 되기 때문에 극댓값이 될 확률은 $\frac{1}{3}$이다. 한편 $j$번째 값이 수열의 양 끝에 위치하는 경우 즉, $j = 1$ 또는 $j = n$이면 인접한 수가 둘이 아닌 하나이기 때문에 극댓값이 될 확률은 $\frac{1}{2}$이다. 이제 기댓값의 **선형성**을 이용하여 확률변수 $I$의 기댓값을 계산한다.

\begin{align}
E(I) \nonumber
\end{align}

\begin{equation\*}
\begin{aligned}
&= E(I_{1} + I_{2} + \cdots + I_{n}) \\\\\\ \\\\\\
&= E(I_{1}) + E(I_{2}) + \cdots + E(I_{n}) \\\\\\ \\\\\\
&= 2 \cdot E(I_{1}) + (n-2) \cdot E(I_{2}) \\\\\\ \\\\\\
&= 2 \cdot \frac{1}{2} + (n-2) \cdot \frac{1}{3} \\\\\\ \\\\\\
&= \frac{n+1}{3}
\end{aligned}
\end{equation\*}

$n=2$인 경우 만들어질 수 있는 수열은 $\[1, \; 2\]$와 $\[2, \; 1\]$의 두 가지 경우뿐이고 각 경우에 대해 모두 극댓값이 하나씩 존재한다. 따라서 기댓값은 $1$인데 위 식의 $n$에 $2$를 대입하더라도 역시 같은 결과인 $1$을 얻을 수 있다.


## 상트페테르부르크 역설

> 동전의 앞면이 나올 때까지 계속 동전을 던진다.  
> $n$번째 시도에 동전의 앞면이 나오면 $2^{n}$달러의 상금을 얻는다.  
> 예를 들어, 첫 동전 던지기에 바로 앞면이 나오면 상금은 $2$달러이다.  
> 위와 같은 도박에 참여하기 위한 공정한 참가비 즉, 도박의 **기댓값**은?

확률변수 $X$를 동전의 앞면이 나올 때까지 **동전을 던지는 횟수**로 정의하고 확률변수 $Y$를 **상금의 액수**로 정의하면 $Y=2^{X}$가 성립한다. 이 때 $Y$의 기댓값은 다음과 같다.

\begin{align}
E(Y) = 2 \cdot \frac{1}{2} + 2^{2} \cdot \frac{1}{2^{2}} + 2^{3} \cdot \frac{1}{2^{3}} + \cdots = \sum_{k=1}^{\infty} 2^{k} \cdot \frac{1}{2^{k}} = 1 + 1 + 1 + \cdots = \infty \nonumber
\end{align}

따라서 동전 던지기 횟수에 별다른 제한이 없는 경우 **기댓값은 발산**하여 존재하지 않는다. 그러나 동전 던지기 횟수에 제한이 있어 최대 $t$번까지만 동전 던지기가 가능하다면 기댓값은 $t$가 될 것이다.

**상트페테르부르크 역설**을 통해 두 가지 사실을 알 수 있다. 첫째, 확률변수의 기댓값이 반드시 존재하는 것은 아니다. 둘째, 기댓값이 존재하지 않는 경우라도 확률변수가 가질 수 있는 값을 한정하는 경우 기댓값 계산이 가능할 수 있다.


* * * 
<br>

# 2. 음이항분포

- [**음이항분포의 정의**](https://pazu0522.github.io/%ED%86%B5%EA%B3%84%ED%95%99/%ED%99%95%EB%A5%A0%EB%A1%A0/stats110_10/#%EC%9D%8C%EC%9D%B4%ED%95%AD%EB%B6%84%ED%8F%AC%EC%9D%98-%EC%A0%95%EC%9D%98)
- [**기댓값**](https://pazu0522.github.io/%ED%86%B5%EA%B3%84%ED%95%99/%ED%99%95%EB%A5%A0%EB%A1%A0/stats110_10/#%EA%B8%B0%EB%8C%93%EA%B0%92)


## 음이항분포의 정의

동일한 성공 확률 $p$를 가지고, 매번 독립적인 여러 번의 베르누이 시행에 대하여 $r$**번째** 성공 전까지의 **실패 횟수**를 확률변수 $X$로 정의했을 때, 확률변수 $X$가 따르는 확률분포를 **음이항분포**라 하며 $X \sim NB(r, p)$와 같이 표기한다. 음이항분포의 PMF는 다음과 같다.

\begin{align}
P(X=k) = \binom{k+r-1}{r-1} p^{r-1}(1-p)^{k} \cdot p = \binom{k+r-1}{r-1} p^{r}(1-p)^{k} \quad k \in \\{0, 1, 2, \cdots \\} \nonumber
\end{align}

<img src="/assets/images/stats_110/lesson_10_2.jpg" width="50%" height="50%" title="example2" alt="example2"/>

만약 동전 던지기에서 앞면이 나오는 것을 성공으로 정의하고 목표 **성공 횟수**를 $5$회, 목표 달성까지 **실패 횟수**를 $11$회로 설정했다면 위와 같은 진행은 초기 설정 조건을 만족하는 결과 중 한 가지이다. 실패 횟수가 $11$회이므로 전체 시행 횟수는 $11+5$회가 된다. 따라서 $X \sim NB(5, \frac{1}{2})$일 때 $P(X=11)$는 마지막 성공을 제외한 총 $11+5-1$개의 자리에 $H$와 $T$를 각각 $5-1$개, $11$개 배치하는 경우의 수를 계산한 다음, 성공 또는 실패할 확률을 각각 곱해주고 마지막 시도에서 성공 확률 $p$ 하나를 추가로 덧붙인 것과 같다.


## 기댓값

$X \sim NB(r, p)$일 때, 확률변수 $X$를 개별 확률변수 $X_{j}$의 합으로 표현할 수 있다. $X_{j}$가 의미하는 것은 $j-1$번째 성공과 $j$번째 성공 사이의 실패 횟수이다. 즉, $X_{1}$은 첫 번째 성공까지의 실패 횟수이고 $X_{2}$는 첫 번째 성공과 두 번째 성공 사이의 실패 횟수이다. 따라서 $X_{1}$부터 $X_{r}$까지의 합은 $r$번째 성공까지의 총 실패 횟수와 일치하므로 $X = X_{1} + X_{2} + \cdots + X_{r}$가 성립한다.

그런데 각각의 $X_{j}$ 입장에서 생각하면, $X_{j}$는 **첫 성공까지의 실패 횟수**와 같으며 각각의 $X_{j}$는 서로 **독립**이다. 정말 운이 좋지 않게 첫 번째 성공이 나오기까지 많은 시행을 거쳤다고 하더라도, 그것과 관계 없이 두 번째 성공은 빠르게 나타날 수 있다. 매 시행이 독립적인 베르누이 시행이기 때문에 이전 시행의 결과들이 현재 시행의 결과에 아무런 영향을 미치지 못하기 때문이다. 따라서 $X_{j} \sim Geom(p)$이다. 기댓값의 **선형성**에 의해 $E(X) = E(X_{1}) + E(X_{2}) + \cdots + E(X_{r})$이고 [기하분포를 따르는 확률변수](https://pazu0522.github.io/%ED%86%B5%EA%B3%84%ED%95%99/%ED%99%95%EB%A5%A0%EB%A1%A0/stats110_09/#%EA%B8%B0%EB%8C%93%EA%B0%92) $X_{j}$의 기댓값 $E(X_{j}) = \frac{q}{p}$이므로 $E(X) = \frac{q}{p} \cdot r = \frac{rq}{p}$이다.

