---
title:  "확률론 기초(Stats 110) : Lesson 04. Conditional Probability"
excerpt: "하버드 대학교 조셉 K. 블리츠타인 교수의 Stats 110 4강 정리"

categories:
  - 통계학
  - 확률론
tags:
  - 독립
  - 조건부 확률
use_math: true
comments: true
last_modified_at: 2021-02-03T23:30:00
header:
  image: /assets/images/texture.jpg
---

<img src="/assets/images/stats_110/lesson_04.jpg" width="80%" height="80%" title="lighthouse" alt="lighthouse"/> 

# 1. 독립

- [**배반과 독립**](https://pazu0522.github.io/%ED%86%B5%EA%B3%84%ED%95%99/%ED%99%95%EB%A5%A0%EB%A1%A0/stats110_04/#%EB%B0%B0%EB%B0%98%EA%B3%BC-%EB%8F%85%EB%A6%BD)
- [**주사위 도박 문제**](https://pazu0522.github.io/%ED%86%B5%EA%B3%84%ED%95%99/%ED%99%95%EB%A5%A0%EB%A1%A0/stats110_04/#%EC%A3%BC%EC%82%AC%EC%9C%84-%EB%8F%84%EB%B0%95-%EB%AC%B8%EC%A0%9C)


## 배반과 독립
  
사건 $A$와 사건 $B$가 **배반**이라면, 사건 $A$가 발생하면 사건 $B$가 발생할 수 없고 마찬가지로 사건 $B$가 발생하면 사건 $A$가 발생할 수 없음을 의미한다.  

사건 $A$와 사건 $B$가 **독립**이라면, 사건 $A$와 사건 $B$가 모두 발생하는 사건인 $A \cap B$에 대하여 $P(A \cap B) = P(A) \times P(B)$가 성립함을 의미한다.

사건 $A, B, C$가 서로 독립이라면, 아래 모든 조건이 성립해야만 독립이 성립한다. 단 한 가지 조건이라도 충족하지 못하는 경우 독립이 아니다.

\begin{align}
P(A, B) = P(A) \cdot P(B), \quad P(B, C) = P(B) \cdot P(C), \quad P(C, A) = P(A) \cdot P(C) \nonumber
\end{align}
\begin{align}
P(A, B, C) = P(A) \cdot P(B) \cdot P(C) \nonumber
\end{align}

따라서 사건 $A_{1}, A_{2}, \cdots, A_{n}$이 서로 독립이라면, 어떤 조합의 교사건이든 그것의 확률이 교사건을 구성하는 개별 사건들의 확률 곱과 일치해야 함을 알 수 있다.


## 주사위 도박 문제

> 다음 중 승리 확률이 가장 높은 도박 조건은 무엇인가?  
> 단, 주사위 던지기는 독립 시행이다.

- 조건 $A$ : $6$개의 주사위를 던져 적어도 $1$개의 주사위가 6이 나오는 경우 승리한다.
- 조건 $B$ : $12$개의 주사위를 던져 적어도 $2$개의 주사위가 6이 나오는 경우 승리한다.
- 조건 $C$ : $18$개의 주사위를 던져 적어도 $3$개의 주사위가 6이 나오는 경우 승리한다.

조건 $A$의 승리 확률은 **여사건**을 이용하여 계산하면 편리하다. 즉, $1$에서 $6$개의 주사위가 모두 6이 나오지 않을 확률인 $P(X_{0})$을 빼면 된다. 그리고 주사위 던지기는 **독립 시행**이므로 $P(X_{0})$는 6개 주사위 각각이 6이 나오지 않을 확률들의 곱연산으로 계산된다. 따라서 $P(A) = 1-P(X_{0}) = 1-(\frac{5}{6})^{6} \approx 0.665$이다.

같은 원리로 조건 $B$의 승리 확률 또한 여사건을 이용하여 계산한다. $1$에서 $12$개의 주사위가 모두 6이 나오지 않을 확률인 $P(X_{0})$을 뺀 다음, $12$개의 주사위 중 하나의 주사위만 6이 나올 확률인 $P(X_{1})$를 추가로 빼면 된다. 따라서 $P(B)$는 아래와 같이 계산된다.

\begin{align}
P(B) = 1-P(X_{0})-P(X_{1}) = 1-(\frac{5}{6})^{12}-\binom{12}{1}(\frac{1}{6})^{1}(\frac{5}{6})^{11} \approx 0.619 \nonumber
\end{align}

마지막으로 $P(C)$는 아래와 같이 계산된다. 역시 원리는 동일하다.

\begin{align}
P(C) \nonumber
\end{align}
\begin{equation\*}
\begin{aligned}
&= 1-P(X_{0})-P(X_{1})-P(X_{2}) \\\\\\ \\\\\\
&= 1-(\frac{5}{6})^{18}-\binom{12}{1}(\frac{1}{6})^{1}(\frac{5}{6})^{17}-\binom{12}{2}(\frac{1}{6})^{2}(\frac{5}{6})^{16} \\\\\\ \\\\\\
&\approx 0.619 \nonumber
\end{aligned}
\end{equation\*}

계산한 근사값을 확인했을 때 조건 $A$의 승리 확률이 가장 높음을 확인할 수 있다.

* * * 
<br>

# 2. 조건부 확률

- [**조건부 확률의 정의**](https://pazu0522.github.io/%ED%86%B5%EA%B3%84%ED%95%99/%ED%99%95%EB%A5%A0%EB%A1%A0/stats110_04/#%EC%A1%B0%EA%B1%B4%EB%B6%80-%ED%99%95%EB%A5%A0%EC%9D%98-%EC%A0%95%EC%9D%98)
- [**직관적 해석**](https://pazu0522.github.io/%ED%86%B5%EA%B3%84%ED%95%99/%ED%99%95%EB%A5%A0%EB%A1%A0/stats110_04/#%EC%A7%81%EA%B4%80%EC%A0%81-%ED%95%B4%EC%84%9D)


## 조건부 확률의 정의

- $P(A \mid B) = \frac {P(A \cap B)}{P(B)}, \quad if \;\; P(B) > 0$

'**새로운 정보**가 주어졌을 때 **불확실성**을 어떻게 **갱신**할 것인가?' 조건부 확률은 이 질문에 대한 해답을 제공한다.

만약 $A$와 사건 $B$가 서로 **독립이 아니라면** 사건 $B$의 발생은 사건 $A$의 발생 확률을 추론하는 데 매우 가치 있는 정보로 활용된다. 예를 들어 이번 설날에 고모부가 나에게 줄 세뱃돈의 액수를 추론한다면 작년 설날에 고모부에게 받은 세뱃돈 액수를 자연스럽게 떠올리게 된다. 만약 작년에 10만원을 받았다면 별 일이 없으면 올해도 10만원을 받을 것으로 예상할 것이다. 그런데 고모부가 자영업자이고 COVID-19 때문에 매출에 큰 타격을 받았다면 이야기는 조금 달라진다. COVID-19라는 새로운 사건이 발생하는 바람에 올해는 한 5만원 정도 받을 것으로 기대치를 낮출 것이다.

이처럼 특정 사건의 발생은 관심 있는 사건의 발생 확률을 추론하는 데 기여를 한다. 조건부 확률은 이러한 사실을 반영한다. 즉, 조건부 확률 $P(A \mid B)$는 사건 $B$가 발생하였을 때 갱신되는 사건 $A$의 발생 확률을 의미한다.

한편, 사건 $A$와 사건 $B$가 서로 **독립**이라면 사건 $B$의 발생은 사건 $A$와 무관하기 때문에 사건 $B$의 발생 여부와 관계 없이 사건 $A$의 발생 확률은 일정할 것이다. 아랫집 사는 8살 철수가 초등학교에서 받아 온 받아쓰기 점수는 고등학생인 내가 모의고사 언어영역에서 받게 될 점수와 전혀 무관하다.(동네의 전반적인 학구열까지 고려한다면 두 사건이 독립이 아니라 주장할 수도 있지만 거기까지는 고려하지 않는다.) 따라서 이 경우에 조건부 확률 $P(A \mid B)$는 $P(A)$와 같다.


## 직관적 해석

<img src="/assets/images/stats_110/lesson_04_1.jpg" width="40%" height="40%" title="example1" alt="example1"/>

그런데 조건부 확률 $P(A \mid B)$를 계산할 때 왜 하필 $P(A \cap B)$를 $P(B)$로 나누는 것일까? 이에 대한 직관적인 해석은 아래와 같다.

그림과 같이 표본 공간에 12개의 조약돌이 존재하고 그 조약돌의 질량 합이 $1$이라고 가정한다. 사건 $B$가 발생한 시점에서 사건 $B$가 차지하고 있는 공간 밖 조약돌은 $P(A)$를 계산할 때 더 이상 고려하지 않는다. 구하고자 하는 $P(A \mid B)$가 사건 $B$ 하에서의 사건 $A$의 발생 확률이기 때문이다. 조건부 확률의 의미에 부합하는 조약돌은 이제 $A \cap B$에 위치한 하나의 빨간 조약돌뿐이다.

그런데 사건 $B$가 발생한 시점에서 표본 공간을 $S$에서 $B$로 축소하였기 때문에 새로운 표본 공간 $B$에 속한 조약돌의 질량 합을 다시 $1$로 맞추어야 할 필요가 있다. 결국 질량 합의 정규화를 위해 $P(A \cap B)$를 $P(B)$로 나누어 주는 것이다.

